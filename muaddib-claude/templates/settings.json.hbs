{{!-- templates/settings.json.hbs --}}
{{!-- Claude Code settings generated by Muad'Dib --}}
{{!-- Project: {{projectName}} | Type: {{projectType}} | Maturity: {{maturity}} --}}
{
  "hooks": {
{{#if strictMode}}
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [{
          "type": "command",
          "command": "~/.muaddib/scripts/validate-bash-command.sh \"$TOOL_INPUT\""
        }]
      },
      {
        "matcher": "Edit|Write",
        "hooks": [{
          "type": "command",
          "command": "~/.muaddib/scripts/pre-edit-check.sh \"$FILE\""
        }]
      }
    ],
{{/if}}
    "PostToolUse": [
      {
        "matcher": "Edit|Write",
        "hooks": [
{{#if (eq projectType "node")}}
          {"type": "command", "command": "npx prettier --write \"$FILE\" 2>/dev/null || true"},
          {"type": "command", "command": "npx eslint --fix \"$FILE\" 2>/dev/null || true"}
{{else if (eq projectType "python")}}
          {"type": "command", "command": "black \"$FILE\" 2>/dev/null || true"},
          {"type": "command", "command": "ruff check --fix \"$FILE\" 2>/dev/null || true"}
{{else if (eq projectType "go")}}
          {"type": "command", "command": "gofmt -w \"$FILE\" 2>/dev/null || true"}
{{else if (eq projectType "rust")}}
          {"type": "command", "command": "rustfmt \"$FILE\" 2>/dev/null || true"}
{{else}}
          {"type": "command", "command": "~/.muaddib/scripts/post-edit-log.sh \"$FILE\""}
{{/if}}
        ]
      }
    ],
    "SessionStart": [
      {
        "hooks": [{
          "type": "command",
          "command": "cat .claude/context.md 2>/dev/null || true"
        }]
      }
    ],
    "Stop": [
      {
        "hooks": [{
          "type": "command",
          "command": "~/.muaddib/scripts/session-end.sh 2>/dev/null || true"
        }]
      }
    ],
    "PreCompact": [
      {
        "hooks": [{
          "type": "command",
          "command": "cat .claude/critical-context.md 2>/dev/null || true"
        }]
      }
    ]
  },
  "permissions": {
    "allow": [
{{#if (eq projectType "node")}}
      "Bash(git *)",
      "Bash(npm *)",
      "Bash(npx prettier *)",
      "Bash(npx eslint *)",
      "Bash(npx jest *)",
      "Bash(npx tsc *)",
      "Bash(node *)",
      "Bash(ls *)",
      "Bash(mkdir *)",
      "Bash(cp *)",
      "Bash(mv *)",
      "Bash(* --help)",
      "Bash(* --version)",
      "Bash(* -h)",
      "Bash(* -v)"
{{else if (eq projectType "python")}}
      "Bash(git *)",
      "Bash(python *)",
      "Bash(python3 *)",
      "Bash(pip *)",
      "Bash(pip3 *)",
      "Bash(pytest *)",
      "Bash(black *)",
      "Bash(ruff *)",
      "Bash(ls *)",
      "Bash(mkdir *)",
      "Bash(cp *)",
      "Bash(mv *)",
      "Bash(* --help)",
      "Bash(* --version)",
      "Bash(* -h)",
      "Bash(* -v)"
{{else if (eq projectType "go")}}
      "Bash(git *)",
      "Bash(go *)",
      "Bash(gofmt *)",
      "Bash(make *)",
      "Bash(ls *)",
      "Bash(mkdir *)",
      "Bash(cp *)",
      "Bash(mv *)",
      "Bash(* --help)",
      "Bash(* --version)",
      "Bash(* -h)",
      "Bash(* -v)"
{{else if (eq projectType "rust")}}
      "Bash(git *)",
      "Bash(cargo *)",
      "Bash(rustc *)",
      "Bash(rustfmt *)",
      "Bash(ls *)",
      "Bash(mkdir *)",
      "Bash(cp *)",
      "Bash(mv *)",
      "Bash(* --help)",
      "Bash(* --version)",
      "Bash(* -h)",
      "Bash(* -v)"
{{else}}
      "Bash(git *)",
      "Bash(ls *)",
      "Bash(mkdir *)",
      "Bash(cp *)",
      "Bash(mv *)",
      "Bash(* --help)",
      "Bash(* --version)",
      "Bash(* -h)",
      "Bash(* -v)"
{{/if}}
    ],
    "deny": [
      "Bash(rm -rf /*)",
      "Bash(rm -rf ~*)",
      "Bash(rm -rf /)",
      "Bash(curl *)",
      "Bash(wget *)",
      "Bash(sudo *)",
      "Bash(chmod 777 *)",
      "Bash(env *)",
      "Read(.env)",
      "Read(.env.*)",
      "Read(.envrc)",
      "Read(**/.env)",
      "Read(**/.env.*)",
      "Read(**/.envrc)",
      "Read(**/secrets/**)",
      "Read(**/*kubeconfig*)",
      "Read(**/*.tfvars)",
      "Read(**/*.tfstate)",
      "Read(**/*.tfstate.*)",
      "Read(**/credentials*)",
      "Read(**/*secret*)",
      "Read(**/*password*)",
      "Read(**/*.pem)",
      "Read(**/*.key)",
      "Write(.env)",
      "Write(.env.*)",
      "Write(.envrc)",
      "Write(**/.env)",
      "Write(**/.env.*)",
      "Write(**/.envrc)",
      "Write(**/secrets/**)",
      "Write(**/*kubeconfig*)",
      "Write(**/*.tfvars)",
      "Write(**/*.tfstate)",
      "Write(**/*.tfstate.*)",
      "Write(**/credentials*)",
      "Write(**/*secret*)",
      "Write(**/*password*)",
      "Write(**/*.pem)",
      "Write(**/*.key)"
    ]
  }
}
